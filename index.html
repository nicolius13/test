<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <!-- Bootstrap icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css" />

    <title>Test form</title>
  </head>
  <body>
    <div class="container mt-5">
      <div class="row">
        <div class="col">
          <h1>Test Form</h1>
        </div>
        <div class="col d-flex align-items-end justify-content-end">
          <button id="addRule" class="btn btn-primary"><i class="bi bi-plus"></i>Add rule</button>
        </div>
      </div>
      <!-- Form -->
      <form id="form" novalidate>
        <table id="formTable" class="table table-borderless custom-stripe align-middle mt-3">
          <colgroup>
            <col class="col-auto" />
            <col class="col-12" />
            <col class="col-auto" />
            <col class="col-auto" />
          </colgroup>
          <thead>
            <tr class="border-bottom border-dark">
              <th>Id</th>
              <th>Rule</th>
              <th>Edit</th>
              <th>Remove</th>
            </tr>
          </thead>
          <tbody>
            <tr id="rule-0" data-id="0" style="display: none">
              <td data-name="number"><p class="mb-0">0</p></td>
              <!-- Rule name -->
              <td data-name="rule-name">
                <div>
                  <div class="input-group">
                    <input
                      name="ruleName"
                      data-id="0"
                      value="New rule"
                      type="text"
                      readonly
                      class="form-control-plaintext name-input"
                    />
                    <button data-id="0" class="btn btn-outline-secondary name-save" style="display: none">
                      <i class="bi bi-check-lg"></i>
                    </button>
                  </div>
                  <a data-id="0" role="button" class="name-btn text-decoration-none collapse editor-collapse-0"
                    >Edit rule name</a
                  >
                </div>
              </td>
              <!-- Edit -->
              <td data-name="edit">
                <button
                  class="btn btn-link"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target=".editor-collapse-0"
                  aria-expanded="false"
                >
                  <i class="bi bi-pencil text-success"></i>
                </button>
              </td>
              <!-- Remove -->
              <td data-name="remove">
                <button class="btn btn-link remove-btn" data-id="0">
                  <i class="bi bi-trash text-danger"></i>
                </button>
              </td>
            </tr>
            <!-- Rule editor -->
            <tr id="editor-0" data-id="0" style="display: none">
              <td colspan="5" class="p-0" data-name="editor">
                <div class="collapse editor-collapse-0 p-2">
                  <!-- Condition -->
                  <div data-id="0" class="conditions">
                    <div data-id="0" data-cond="0" class="row condition-row">
                      <div class="col-10 col-md d-flex">
                        <label class="me-2">If value</label>
                        <input name="condLeft" data-id="0" type="text" class="form-control col" />
                      </div>
                      <div class="col-10 col-md my-2 my-md-0">
                        <select name="condSelect" data-id="0" aria-label="operator select" class="form-select">
                          <option value="contain">Contain</option>
                          <option value="isNot">Is Not</option>
                          <option value="exactlyIs">Exactly Is</option>
                        </select>
                      </div>
                      <div class="col-2 col-md-auto order-md-last ms-auto add-c-col">
                        <button data-id="0" class="btn btn-outline-primary condition-add">
                          <i class="bi bi-plus"></i>
                        </button>
                      </div>
                      <div class="col-2 col-md-auto order-md-last ms-auto remove-c-col" style="display: none">
                        <button data-id="0" data-cond="0" class="btn btn-link condition-remove">
                          <i class="bi bi-trash text-danger"></i>
                        </button>
                      </div>
                      <div class="col-10 col-md">
                        <input name="condRight" data-id="0" type="text" class="form-control" />
                      </div>
                    </div>
                  </div>
                  <!-- Action -->
                  <div data-id="0" class="actions mt-3">
                    <div data-id="0" data-act="0" class="row mt-2 action-row">
                      <label class="col-auto col-form-label">Then</label>
                      <div class="col">
                        <input name="action" data-id="0" type="text" class="form-control" />
                      </div>
                      <div class="col-auto remove-a-col" style="display: none">
                        <button data-id="0" data-act="0" class="btn btn-link action-remove">
                          <i class="bi bi-trash text-danger"></i>
                        </button>
                      </div>
                      <div class="col-auto add-a-col">
                        <button data-id="0" class="btn btn-outline-primary action-add">
                          <i class="bi bi-plus"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                  <div class="row mt-3 justify-content-end">
                    <div class="col-auto">
                      <button
                        class="btn btn-link text-decoration-none"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target=".editor-collapse-0"
                        aria-expanded="false"
                      >
                        Close
                      </button>
                    </div>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
        <button type="submit" class="submit-btn btn btn-primary mb-3" disabled>Submit</button>
      </form>

      <!-- TOAST -->
      <div class="position-fixed top-0 end-0 p-3" style="z-index: 11">
        <div id="errorToast" class="toast bg-warning" role="alert" aria-live="assertive" aria-atomic="true">
          <div class="toast-header">
            <strong class="me-auto">Something's missing</strong>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
          </div>
          <div class="toast-body">Some rule have empty field(s) !</div>
        </div>
      </div>
    </div>

    <!--  Bootstrap JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>
    <!-- JQuery -->
    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous"
    ></script>

    <script src="./script.js"></script>

    <style>
      .custom-stripe > tbody > tr:nth-of-type(4n + 1) > *,
      .custom-stripe > tbody > tr:nth-of-type(4n + 2) > * {
        --bs-table-accent-bg: var(--bs-table-striped-bg);
        color: var(--bs-table-striped-color);
      }
    </style>
  </body>
</html>
